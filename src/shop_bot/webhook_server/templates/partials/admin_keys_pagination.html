{% set cp = current_page or 1 %}
{% set tp = total_pages or 1 %}
{% set query = q or '' %}
{% set cf = current_filter or 'general' %}
{% set ns = namespace(last_m=1, last_d=1) %}
{% if tp > 1 %}
{% if cp > 1 %}
<a class="px-3 py-1 rounded bg-white/10 hover:bg-white/20 text-white text-sm"
    href="{{ url_for('admin_keys_page', page=cp-1, q=query, filter=cf) }}">«</a>
{% endif %}
<a class="px-3 py-1 rounded {% if 1 == cp %}bg-primary text-background-dark{% else %}bg-white/10 hover:bg-white/20 text-white{% endif %} text-sm"
    href="{{ url_for('admin_keys_page', page=1, q=query, filter=cf) }}">1</a>
{% for p in range(2, tp + 1) %}
{% set diff = (p - cp)|abs %}
{% set is_m = (p == tp) or (diff <= 1) %} {% set is_d=(p==tp) or (p <=4) or (p>= tp - 3) or (diff <= 2) %} {% if is_m or
        is_d %} {% set gap_m=is_m and (p - ns.last_m> 1) %}
        {% set gap_d = is_d and (p - ns.last_d > 1) %}
        {% if gap_m and gap_d %}
        <span class="px-1 text-white/50 text-sm">...</span>
        {% elif gap_d %}
        <span class="px-1 text-white/50 text-sm hidden md:inline-block">...</span>
        {% elif gap_m %}
        <span class="px-1 text-white/50 text-sm md:hidden">...</span>
        {% endif %}
        <a class="px-3 py-1 rounded {% if p == cp %}bg-primary text-background-dark{% else %}bg-white/10 hover:bg-white/20 text-white{% endif %} text-sm {% if not is_m %}hidden md:inline-block{% endif %}"
            href="{{ url_for('admin_keys_page', page=p, q=query, filter=cf) }}">{{ p }}</a>
        {% if is_m %}{% set ns.last_m = p %}{% endif %}
        {% if is_d %}{% set ns.last_d = p %}{% endif %}
        {% endif %}
        {% endfor %}
        {% if cp < tp %} <a class="px-3 py-1 rounded bg-white/10 hover:bg-white/20 text-white text-sm"
            href="{{ url_for('admin_keys_page', page=cp+1, q=query, filter=cf) }}">»</a>
            {% endif %}
            {% endif %}