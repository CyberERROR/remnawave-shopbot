{% for tx in transactions %}
<tr class="transition-colors border-b border-white/5 last:border-0 group">
    <td class="px-5 py-4 whitespace-nowrap">
        <div class="flex items-center gap-3">
            <div class="w-8 h-8 rounded-lg bg-white/5 flex items-center justify-center text-white/40">
                <span class="material-symbols-outlined text-sm">person</span>
            </div>
            <div>
                <div class="text-sm font-bold text-white">{{ tx.username or 'N/A' }}</div>
                <div class="text-[10px] text-white/50 font-mono tracking-wide">{{ tx.user_id }}</div>
            </div>
        </div>
    </td>
    <td class="px-5 py-4 whitespace-nowrap">
        {% if tx.action == 'top_up' or tx.action == 'topup' %}
        <div class="text-sm font-medium text-white">Пополнение баланса</div>
        <div class="text-xs text-white/50 flex items-center gap-1">
            <span class="material-symbols-outlined text-[10px]">account_balance_wallet</span>
            Кошелек
        </div>
        {% else %}
        <div class="text-sm font-medium text-white">{{ tx.plan_name }}</div>
        <div class="text-xs text-white/50 flex items-center gap-1">
            <span class="material-symbols-outlined text-[10px]">dns</span>
            {{ tx.host_name }}
        </div>
        {% endif %}
    </td>
    <td class="px-5 py-4 whitespace-nowrap">
        <div class="text-sm font-bold text-white tracking-wide">{{ tx.amount_rub | round(2) }} ₽</div>
        <div class="mt-1.5">
            {% set method = tx.payment_method|lower if tx.payment_method else '' %}
            {% set badge_style %}
            {% if method == 'yookassa' %}bg-blue-500/10 text-blue-400 border-blue-500/20
            {% elif method == 'cryptobot' %}bg-yellow-500/10 text-yellow-400 border-yellow-500/20
            {% elif method == 'ton' %}bg-cyan-500/10 text-cyan-400 border-cyan-500/20
            {% elif method == 'stars' %}bg-purple-500/10 text-purple-400 border-purple-500/20
            {% elif method == 'balance' %}bg-green-500/10 text-green-400 border-green-500/20
            {% elif method == 'yoomoney' %}bg-orange-500/10 text-orange-400 border-orange-500/20
            {% elif method == 'heleket' %}bg-pink-500/10 text-pink-400 border-pink-500/20
            {% elif method == 'platega' %}bg-indigo-500/10 text-indigo-400 border-indigo-500/20
            {% else %}bg-white/5 text-white/50 border-white/10
            {% endif %}
            {% endset %}
            <span
                class="inline-flex items-center px-2 py-0.5 rounded-md border text-[9px] uppercase font-bold tracking-widest {{ badge_style }}">
                {{ tx.payment_method or 'N/A' }}
            </span>
        </div>
    </td>
    <td class="px-5 py-4 whitespace-nowrap">
        {% if tx.created_date %}
        {% set d_parts = tx.created_date.split(' ')[0].split('-') %}
        <div class="text-sm text-white">{{ d_parts[1] }}.{{ d_parts[2] }}<br><span class="text-white/50 text-xs">{{
                tx.created_date | relative_time }}</span></div>
        {% else %}
        <div class="text-sm text-white">N/A</div>
        {% endif %}
    </td>
    <td class="px-5 py-4 whitespace-nowrap text-right">
        <a href="{{ url_for('users_page', q=tx.user_id) }}"
            class="inline-flex items-center justify-center w-8 h-8 rounded-lg bg-white/5 text-white/30 hover:bg-primary/20 hover:text-primary transition-all duration-300"
            title="Профиль">
            <span class="material-symbols-outlined text-sm">arrow_forward</span>
        </a>
    </td>
</tr>
{% endfor %}